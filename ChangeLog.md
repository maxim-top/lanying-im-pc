# 蓝莺 IM PC 版本更新记录

[蓝莺IM](https://www.lanyingim.com/)，是由美信拓扑团队研发的新一代即时通讯云服务，SDK设计简单集成方便，服务采用云原生技术和多云架构，私有云也可按月付费。

### v3.2.3 20240806
1.修复群组内只能看到自己的消息看不到其他人发送消息的问题。
2.修改群组内@消息列表的处理逻辑，@列表展示用户名支持群内隐藏消息，@消息内容同步支持使用群隐藏用户名。
3.群组内对于群隐藏用户，即没有设置群昵称及个人昵称的用户。自己的用户名也展示为隐藏用户名。
4.修复群组内已读消息处理后展示的未读数清除很慢的问题。

### v3.2.2 20240806
1.移除用户设置别名相关的展示机操作接口，针对联系人只保留昵称、用户名和 id信息。
2.更新选择切换按钮的样式。
3.修改群组隐藏详细的设计逻辑，用户设置了群昵称及个人昵称的情况下仍然使用设置的信息，只有使用用户名的情况下才进行隐藏。
4.修改群组设置页面的群用户名称展示逻辑，保证设置界面也可以正常使用隐藏群信息的用户名逻辑。
5.针对用户名密码错误的场景修改尝试自动登录时频繁弹出alert 错误提示的问题，改为使用Element 消息提示方式，减少客户手动点击频率。
6.修改 appid 输入错误的情况下 dns 的报错逻辑处理，保证登录时显著提示 appid 设置错误。
7.移除群组header信息栏中无用的@消息提示。
8.floo web sdk中新增禁言群用户的处理逻辑。
9.修改群组聊天框中输入栏的处理逻辑，可以正常的展示被禁言及收到长链接禁言通知后可以正确显示禁言状态。

### v3.2.1 20240801

1.修复 页面存储账号信息在从明文模式切换到加密模式时可能出现的兼容问题。
2.修复群组黑名单操作或者删除群成员后出现的整个用户所有群成员列表清空的bug。
3.修复群组设置界面群成员过多不能正常展示群设置弹出窗口的问题。
4.修改群组设置界面设置及展示群公告的样式。
5.修改群组设置界面操作处理后选择的选项没有被清空的问题。
6.修改群组共享文件的操作处理界面的样式。
7.修改群组设置界面的禁言设置操作展示，被禁言的状态的成员使用红色展示。

### v3.2.0 20240727
1.增加多账号切换登录功能。
2.修改floo web页面二维码扫描输出内容及格式，与app和小程序保持一致。
3.修复修改昵称是导航条中展示名字不同步变更的问题。
4.增加当前APP用户数已达上限时提示请使用已有账号登录或联系管理员开通商业版。
5.修复对话框头部偶尔不能展示好友或者群组名称导致的不能查看对方profile的问题。
6.设置页面及查看对方profile页面新增展示昵称及设置昵称功能。
7.修复用户设置群名片限制，任何用户都允许设置自己的群名片。
8.修复用户名过长时群成员列表展示位置错乱的问题。
9.修复群成员列表不能滑动的问题。
10.修改@消息的弹出列表式样。
11.使用 用户别名 > 用户昵称 > 用户名 > 用户id的展示顺序来展示用户名。
12.在群组内使用 用户别名 > 用户群名片 > 用户昵称 > 用户名 > 用户id的展示顺序来展示用户名。
13.在联系人profile界面新增用户别名展示。
14.修复群聊内@消息的展示格式不正确及@消息的消息操作标签展示位置不正确的问题。
15.floo sdk增加异步更改用户密码接口。
16.floo web增加群组聊天界面@提示功能。
17.修复部分界面逻辑错误bug。
18.修复转发消息不可用的bug。
19.修改转发列表展示样式。
20.修复群聊不能撤回消息及不能执行消息删除的问题。
21.群组增加群管理员和群主可以撤回普通成员发送消息的功能。
22.floo web中新增多tab中支持多个账号同时登录的功能。
23.floo web端退出登录操作逻辑修改，支持退出时同时退出所有web端和只退出当前登录网页端功能。
24.修改floo web的当前登录用户及已登录用户列表的信息存储方式，使用固定的加密key将用户名和密码加密存储。
25.按照 floo 移动端逻辑优化了 floo web 端流式消息的展示逻辑。
26.优化 dns 获取逻辑，在每次使用本地存储 dns 后后台自动下载一次最新的服务器 dns 配置文件。
27.修复私有部署环境下音视频单聊不能正常通话的问题。
28.floo sdk 新增获取 app config和群组设置是否对普通群成员隐藏其它群成员详情功能。
29.floo web 新增设置群组是否对普通群成员隐藏其它群成员详情功能及隐藏状态下使用加密方式展示用户信息功能。

### v3.1.2 20231127
1.单聊、群聊及LinkChat界面增加流式消息展示功能。
2.修复历史消息获取的流式消息仍然使用流式消息展示的问题。
3.文本消息新增功能按钮可以展示消息的扩展信息。
4.修复AI同时回复多条消息时出现的消息展示错乱问题。
5.support页面新增参数确保safri跳转聊天时使用同一个账号。
6.support页面新增其它会话未读数展示功能。
7.调整markdown信息展示格式及support页面展示格式。
8.support页面新增其它会话未读数展示功能。
9.调整markdown信息展示格式及support页面展示格式。
10.修改音视频信令逻辑，新增 rtc record 指令用于展示通话记录。
11.修改 sdk 处理 rtc 信令逻辑，sdk 中只存储 rtc record 信令，其它 rtc 信令不保存。
12.修改 sdk 处理 会话最新消息逻辑，过滤 rtc 非 record 消息，确保 conversation 中会话最新消息不会展示其它 rtc 消息。
13.修改音视频通话 janus 信令执行流程，会话发起端在接收到对方的 pickup 消息之后才会开始加入房间等后续逻辑处理，在两端都发布流之后才正式进入通话状态。
14.修改通话接收端逻辑，接收端同样使用 initRTCEngine 初始化音视频环境，初始化后执行 joinRoom 执行加入房间逻辑。
15.修改对端音视频流检测逻辑，检测到对端异常结束流发布后自动执行挂断操作。
16.通话建立之前，通话界面仅挂断按钮有效，屏蔽其它按键操作。
17.通话建立之前，使用本地渲染来展示本地视频展示。
18.修改支持页面启动会话页面逻辑，使用服务器返回凭证获取用户信息进行登录，确保 safari 浏览器多tab 页面下使用相同账户登录。
19.增加延迟启动音视频通话逻辑，确保过滤该设备历史离线队列中多设备支持其他端同步的历史通话消息唤醒音视频呼叫。

### v3.1.1 20230717
1.PC端支持Ubuntu安装包。
2.同步floo-web解决音视频相关bug。

### v3.1.0 20230620
1. 单聊新增1v1音视频功能。

### v3.0.1 20230310
1. 修复删除会话后不会收到删除会话事件的问题。
2. 增加好友申请事件通知（onRosterApplied）。
3. 修复退出并登录新用户时，可能会加载旧用户的数据的问题。
4. 支持设置sdk日志等级。
5. 通讯录页面增加客服列表。
6. 修复退出群不会触发onGroupMemberChanged事件的问题。
7. 修复noticeStore.saveNotice报错问题。

### v3.0.0 20220425
1.启用蓝莺产品名称，基于原"美信拓扑IM"v2.9.10发布全新版本。

### v2.9.10 20220425
1. Fix Bug: 修复显示好友信息的bug。
2. Fix Bug: 联系人信息未被获取时返回空对象。
3. Fix Bug: 禁用polling。
4. Fix Bug: 用户登陆退出后增加页面刷新功能，修复新登录用户可能获取之前登陆用户联系人缓存信息。
5. 增加获取登陆的方法。
6. 增加群组禁言功能。
7. 针对sendRosterMessage和sendGroupMessage方法增加返回消息id的操作。
8. 用户头像、群组头像及消息附近上传时增加回调方法。

### v2.9.9 20210811

1. 收取历史消息不需要额外通知；
2. Fix Bug: 获取 roster 失败引发 socket 初始化失败，将会导致 disConnect 时候异常；

### v2.9.8 20210801

1. Fix Bug: 好友信息更新时间应该使用 onRosterInfoUpdate；
2. Fix Bug: 自动登录未正确设置 isLogin，导致同一用户会出现两次登录；
3. Demo bug fix: 好友信息变化后不再触发花名册更新，后者将会在处理不存在用户时引发循环请求；
4. Demo: 显示花名册好友昵称；
5. Demo: 持久化存储 AppID，页面刷新后依然使用上次设置 AppID；

### v2.9.7 20210728

1. Fix Bug: 收到 userNotice 后退出并不再重连；
2. Demo：增加 userNotice 演示；
3. Demo bug fix: 退出登录另一账号后，会话页面消息显示错误判断是否为自己发送；

### v2.9.6 20210723

1. 优化登陆速度至 100ms 以内；
2. Demo：由于登陆速度过快，需要在初始化函数内立即注册监听，否则会丢失登陆成功通知；

### v2.9.5 20210303

1. 限制获取同一 ID 的好友信息频次，一秒内只能发起一次；
2. Fix bug: 群聊信息默认 status 不应为 UNREAD；

### v2.9.4 20210113

1. 支持从服务端获取消息已读未读状态；
2. 与 Uniapp 同步版本；
3. 支持发送定位消息，type: location；
4. Fix bug：偶现情况下 token 失效上报事件使用了 loginFailure 而不是 loginFail；
5. Demo：演示发送定位信息；
6. Demo: 调整未读数显示位置；
7. Demo fix bug: 单聊时不显示自己头像；
8. Demo fix bug：发送消息后显示已读；

### v2.9.3 20210111

1. 使用 prettier 格式化工程；
2. Demo bug fix：修改 AppID 后不初始化；

### v2.9.2 20210110

1. 支持单独获取消息已读未读状态；
2. Fix bug：退出登录后遗留数据清理；
3. Demo: 退出后清理个人 Profile；
4. Demo: 重构历史消息合并逻辑；

### v2.9.1 20210107

1. 私有云文件发送 Bug；
2. Demo: 显示图片原图以及视频封面；

### v2.8.2 20201103

1. 增加 SDK 初始化状态判断方法 im.isReady，并增加示例等待 SDK 初始化成功；
2. 为会话 last message 增加 ext 字段；
3. 重构 ack 存储，修复事件 onUnreadChange；
4. Fix bug: 发送者不应该发送 READ_ACK；
5. 获取历史消息可指定条数：

### v2.8 20200924

1. 适配 v2 DNS 服务，支持国外加速节点；
2. 冻结用户和 LICENSE 相关错误不再触发重新登录；

### v2.7.2 20200915

1. 优化服务 DNS 刷新机制；
2. 增加自定义协议支持，ext 字段解析；
3. 删除会话前增加存在性检查；
4. Websocket 链接出错后回收关闭；
5. Demo：演示自定义协议；
6. Demo: 添加自动登录逻辑；

### v2.7.1 20200903

1. 优化重连策略，在网络不稳定情况下冷却重连超时；
2. 弱网情况下调整最大连接超时为 90s，延迟登陆时间 10s；

### v2.7 20200825 七夕快乐

1. 支持删除远程会话；
2. 删除会话操作从 im 挪到 im.sysManage；
3. Demo：删除好友/群也会触发删除会话；
4. 性能优化：历史聊天记录不再触发 ReadAck；
5. 支持内嵌在原生 App 中使用厂商推送，可绑定/解绑 DeviceToken;

### v2.5 20200809

！此次更新涉及数据格式变化，升级注意清空本地缓存

1. 支持删除本地会话；
2. 重构 message 存储，增加分区，极大地提高了性能；

### v2.4 20200730

1. 统一事件通知，增加 flooNotice，dnsError 移到 flooError；
2. 增加用户被封禁登陆失败通知 USER_BANNED；
3. 同步发布 Uniapp 版本；
4. 适配修改，多端版本统一；

### v2.3.5 20200629

1. 演示用户自定义协议，即消息 ext 字段使用；

### v2.3.4 20200522

1. 修改说明文档，解释 sourceType: 'unambiguous' 的重要性；

### v2.3.3 20200430

1. fix bug：视频图片显示路径问题；

### v2.3 20200428

1. 提高文件访问地址 URL 的安全性；
2. 同步小程序解决音频播放问题；

### v2.2 20200425

1. 单独显示系统通知；
2. 演示群组设置；
3. 优化：把 refreshServers 从 io 挪到 dnsManange 里；

### v2.1 20200306

1. 发布使用 2.0 库；
2. 重构存储，合并小程序版本 SDK；

### v1.1 20200225

1. 为聊天室消息增加优先级；

### v1.0 20200223 正式发布

1. 支持单聊、群聊；
2. 支持文本、语音（微信小程序）、图片和视频消息；
3. 支持个人信息、头像；
4. 支持自定义协议；
5. 对接美信拓扑 IM 云服务，设置 appid；
